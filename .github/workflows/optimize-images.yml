# .github/workflows/optimize-images.yml
name: üì∑ Optimize & Resize Images

on:
  push:
    paths:
      - 'season*/**'                           # –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ season1/, season2/‚Ä¶
      - '.github/workflows/optimize-images.yml'

jobs:
  optimize:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v3
      with:
        persist-credentials: false

    - name: Resize oversized images
      uses: petems/image-resizer-gh-action@master
      with:
        target: '.'                             # —Å–∫–∞–Ω–∏—Ä—É–µ–º –≤–µ—Å—å —Ä–µ–ø–æ, –Ω–æ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏
        widthLimit: 1920                        # –º–∞–∫—Å. —à–∏—Ä–∏–Ω–∞
        heightLimit: 1080                       # –º–∞–∫—Å. –≤—ã—Å–æ—Ç–∞

    - name: Compress images
      uses: calibreapp/image-actions@main       # lossless-–∫–æ–º–ø—Ä–µ—Å—Å–∏—è JPEG/PNG/WebP

    - name: Commit optimized images
      uses: stefanzweifel/git-auto-commit-action@v4
      with:
        commit_message: 'chore: optimize & resize images'
        file_pattern: 'season*/**'               # –∫–æ–º–º–∏—Ç–∏–º –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ season*/‚Ä¶
